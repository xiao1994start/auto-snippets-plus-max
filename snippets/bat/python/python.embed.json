{
  "python-embed 嵌入式环境激活": {
    "prefix": ["py_embed_env -python", "py_EV -python"],
    "body": [
      "@ECHO OFF",
      "setlocal enabledelayedexpansion",
      "CD /D \"%~dp0\"",
      "",
      "",
      "for /D %%i in (python*embed*) do ( ren %%i \"python\" )",
      "if not exist \"%~dp0python\" ( ECHO 请先部署 python_embed 环境  && PAUSE && exit /B )",
      "ECHO 修改 python*embed* 目录名为 python",
      "ECHO 创建嵌入式环境工作区设置",
      "if not exist \"%~dp0.vscode\" (",
      "    md \"%~dp0.vscode\"",
      ")",
      "",
      "",
      "if not exist \"%~dp0.vscode\\settings.json\" (",
      "    ECHO 配置项目工作配置文件",
      "    ECHO {> \"%~dp0.vscode\\settings.json\"",
      "    ECHO   \"python.defaultInterpreterPath\": \"\\${workspaceFolder}/python/python.exe\", // * python Interpreter Path>> \"%~dp0.vscode\\settings.json\"",
      "    ECHO   \"qtForPython.designer.path\": \"\\${workspaceFolder}/python/Scripts/pyside6-designer.exe\", // * Qt Designer Path>> \"%~dp0.vscode\\settings.json\"",
      "    ECHO   \"qtForPython.uic.path\": \"\\${workspaceFolder}/python/Scripts/pyside6-uic.exe\", // * PySide6-uic Path>> \"%~dp0.vscode\\settings.json\"",
      "    ECHO   \"qtForPython.rcc.path\": \"\\${workspaceFolder}/python/Scripts/pyside6-rcc.exe\", // * PySide6-rcc Path>> \"%~dp0.vscode\\settings.json\"",
      "    ECHO   \"qtForPython.qml.path\": \"\\${workspaceFolder}/python/Scripts/pyside6-qml.exe\" // * PySide6-qml Path>> \"%~dp0.vscode\\settings.json\"",
      "    ECHO }>> \"%~dp0.vscode\\settings.json\"",
      "    ECHO.>> \"%~dp0.vscode\\settings.json\"",
      "    ECHO.",
      "    ECHO 配置调试启动配置文件",
      "    ECHO {> \"%~dp0.vscode\\launch.json\"",
      "    ECHO  // Help_en: https://go.microsoft.com/fwlink/?linkid=830387>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO  // Help_zh: https://vscode.github.net.cn/docs/python/debugging>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO   \"version\": \"0.2.0\",>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO   \"configurations\": [>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO     {>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO       \"name\": \"Python Debug : Current File\",>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO       \"type\": \"debugpy\",>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO       \"request\": \"launch\",>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO       \"program\": \"\\${file}\", // * Run Debug File>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO       \"python\": \"\\${command:python.interpreterPath}\", // * Default settings.json -^> python.defaultInterpreterPath>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO       \"console\": \"integratedTerminal\",>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO       \"justMyCode\": false,>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO       \"autoReload\": { \"enable\": true },>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO       \"cwd\": \"\\${workspaceFolder}\",>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO       \"env\": {>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO         \"PATH\": \"\\${workspaceFolder}/python;\\${workspaceFolder}/python/Scripts;\\${env:PATH}\">> \"%~dp0.vscode\\launch.json\"",
      "    ECHO       },>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO       \"envFile\": \"\\${workspaceFolder}/.env\">> \"%~dp0.vscode\\launch.json\"",
      "    ECHO     }>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO   ]>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO }>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO.>> \"%~dp0.vscode\\launch.json\"",
      "    ECHO.",
      ")",
      "",
      "",
      "@REM ! 提取本地 python 环境变量中的Tkinter库",
      "@REM ECHO 配置 .env 文件",
      "@REM ECHO PATH=\\${workspaceFolder}/python:\\${workspaceFolder}/python/Scripts:\\${PATH}> \"%~dp0\\.env\"",
      "@REM ECHO 创建 tkinter 框架",
      "@REM if not exist \"%~dp0python\\Lib\\site-packages\" ( md \"%~dp0python\\Lib\\site-packages\" )",
      "@REM ECHO 配置 .\\DLLs 文件 tkinter 相关动态链接库",
      "@REM set remain=%PATH%",
      "@REM :loopPath",
      "@REM for /F \"tokens=1* delims=;\" %%a in (\"%remain%\") do (",
      "@REM     set pyPath=%%a",
      "@REM     if not \"!pyPath:Python=!\"==\"!pyPath!\" (",
      "@REM         if \"!pyPath:Scripts=!\"==\"!pyPath!\" (",
      "@REM             goto :outLoop",
      "@REM         ) else ( set remain=%%b )",
      "@REM     ) else ( set remain=%%b )",
      "@REM )",
      "@REM @REM 如果还有剩余,则继续分割",
      "@REM if defined remain goto :loopPath",
      "@REM :outLoop",
      "@REM ECHO !pyPath!",
      "@REM if not exist \"%~dp0python\\tcl\" ( xcopy /S /E /I /Y \"!pyPath!\\tcl\" \"%~dp0python\\tcl\" )",
      "@REM if not exist \"%~dp0python\\Lib\\site-packages\\tkinter\" ( xcopy /S /E /I /Y \"!pyPath!\\Lib\\tkinter\" \"%~dp0python\\Lib\\site-packages\\tkinter\" )",
      "@REM if not exist \"%~dp0python\\_tkinter.pyd\" ( copy /V /Y \"!pyPath!\\DLLs\\_tkinter.pyd\" \"%~dp0python\" )",
      "@REM if not exist \"%~dp0python\\tcl86t.pyd\" ( copy /V /Y \"!pyPath!\\DLLs\\tcl86t.dll\" \"%~dp0python\" )",
      "@REM if not exist \"%~dp0python\\tk86t.pyd\" ( copy /V /Y \"!pyPath!\\DLLs\\tk86t.dll\" \"%~dp0python\" )",
      "@REM if not exist \"%~dp0python\\zlib1.pyd\" ( copy /V /Y \"!pyPath!\\DLLs\\zlib1.dll\" \"%~dp0python\" )",
      "",
      "",
      "if not exist \"%~dp0.vscode\\ruff.toml\" (",
      "    ECHO 配置 Ruff ruff.toml 格式化规则",
      "    ECHO # help: https://docs.astral.sh/ruff/configuration/> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO [lint]>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # Enable Pyflakes (`F`) and a subset of the pycodestyle (`E`)  codes by default.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # Unlike Flake8, Ruff doesn't enable pycodestyle warnings (`W`) or>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # McCabe complexity (`C901`) by default.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO select = [\"E4\", \"E7\", \"E9\", \"F\"]>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO ignore = [\"Q000\", \"Q001\", \"Q002\", \"F401\", \"F403\", \"F404\"]>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # Allow fix for all enabled rules (when `--fix`) is provided.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO fixable = [\"ALL\"]>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO unfixable = []>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # Allow unused variables when underscore-prefixed.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO dummy-variable-rgx = \"^(_+|(_+[a-zA-Z0-9_]*[a-zA-Z0-9]+?))\\$\">> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO [format]>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # Like Black, use double quotes for strings.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO quote-style = \"single\">> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # Like Black, indent with spaces, rather than tabs.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO indent-style = \"space\">> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # Like Black, respect magic trailing commas.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO skip-magic-trailing-comma = false>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # Like Black, automatically detect the appropriate line ending.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO line-ending = \"auto\">> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # Enable auto-formatting of code examples in docstrings. Markdown,>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # reStructuredText code/literal blocks and doctests are all supported.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO #>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # This is currently disabled by default, but it is planned for this>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # to be opt-out in the future.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO docstring-code-format = false>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # Set the line length limit used when formatting code snippets in>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # docstrings.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO #>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # This only has an effect when the `docstring-code-format` setting is>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO # enabled.>> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO docstring-code-line-length = \"dynamic\">> \"%~dp0.vscode\\ruff.toml\"",
      "    ECHO.>> \"%~dp0.vscode\\ruff.toml\"",
      ")",
      "",
      "",
      "ECHO 设置python embed 环境变量",
      "set systemPath=%path%",
      "@REM systemPath 设置为系统初始化环境变量",
      "set systemPath=C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\bin32;C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\bin;C:\\WINDOWS;C:\\WINDOWS\\system32;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\",
      "set PYTHON_HOME=%~dp0python;%~dp0python\\Scripts",
      "set path=%PYTHON_HOME%;%systemPath%;",
      "ECHO %path%",
      "",
      "",
      "",
      "if not exist \"%~dp0python\\get-pip.py\" (",
      "    ECHO 初始化 get-pip.py",
      "    ECHO.",
      "    @REM todo 进入 python 目录(pip documentation:https://pip.pypa.io/en/stable/installation/ ^| 下载get-pip.py: https://www.python.org/downloads/windows/)",
      "    ECHO 配置 pip 镜像",
      "    ECHO [global]> \"%~dp0python\\pip.ini\"",
      "    ECHO index-url = https://mirrors.aliyun.com/pypi/simple/>> \"%~dp0python\\pip.ini\"",
      "    ECHO [install]>> \"%~dp0python\\pip.ini\"",
      "    ECHO trusted-host=mirrors.aliyun.com>> \"%~dp0python\\pip.ini\"",
      "    ECHO.",
      "    ECHO get-pip.py正在下载...",
      "    curl -sSL https://bootstrap.pypa.io/get-pip.py -o \"%~dp0python\\get-pip.py\"",
      "    ECHO.",
      "    ECHO 修改 python*._pth 导入",
      "    CD /D \"%~dp0python\"",
      "    for %%i in (python*._pth) do (",
      "        for /F \"tokens=*\" %%j in (%%i) do (",
      "            if not \"%%j\"==\"import site\" (",
      "                ECHO %%j>> \"%~dp0python\\python._pth\"",
      "            )",
      "        )",
      "        ECHO import site>> \"%~dp0python\\python._pth\"",
      "        del /F /Q %%i",
      "        ren \"%~dp0python\\python._pth\" %%i",
      "    )",
      "    CD /D \"%~dp0\"",
      "    ECHO.",
      "    ECHO 初始化环境 pip",
      "    python \"%~dp0python\\get-pip.py\" -i https://mirrors.aliyun.com/pypi/simple/",
      "    ECHO.",
      ")",
      "",
      "",
      "ECHO python 版本号",
      "call python --version",
      "ECHO pip 版本号",
      "call pip --version",
      "",
      "ECHO 环境 pip 执行",
      "@REM ECHO 安装虚拟环境 requirements.txt...",
      "@REM pip install -r \"%~dp0\\requirements.txt\" -i https://mirrors.aliyun.com/pypi/simple/",
      "@REM ECHO 安装 Jupyter交互式笔记本环境 内核ipykernel依赖库... @REM * 可选",
      "@REM pip install -U ipykernel -i https://mirrors.aliyun.com/pypi/simple/",
      "ECHO 安装 setuptools 打包分发工具... @REM ! 建议安装",
      "pip install -U setuptools -i https://mirrors.aliyun.com/pypi/simple/",
      "",
      "ECHO 安装依赖库...使用虚拟环境开发时, 直接使用requirements.txt安装依赖库",
      "@REM 使用虚拟环境开发时, 直接使用requirements.txt安装依赖库",
      "$0",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "ECHO 导出依赖库",
      "pip freeze  > \"%~dp0\\requirements.txt\"",
      "",
      "ECHO 完成!",
      ""
    ],
    "description": ["python-embed 嵌入式环境激活"]
  },
  "python-embed 嵌入式环境启动": {
    "prefix": "call_python_embed -python",
    "body": [
      "@ECHO OFF",
      "setlocal enabledelayedexpansion",
      "CD /D \"%~dp0\"",
      "",
      "for /D %%i in (python*embed*) do ( ren %%i \"python\" )",
      "if not exist \"%~dp0python\" ( ECHO 请先部署 python_embed 环境 && exit /B )",
      "ECHO 修改 python*embed* 目录名为 python",
      "ECHO 设置python embed 环境变量",
      "set systemPath=%path%",
      "@REM systemPath 设置为系统初始化环境变量",
      "set systemPath=C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\bin32;C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\bin;C:\\WINDOWS;C:\\WINDOWS\\system32;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\",
      "set PYTHON_HOME=%~dp0python;%~dp0python\\Scripts",
      "set path=%PYTHON_HOME%;%systemPath%;",
      "ECHO %path%",
      "ECHO python 版本号",
      "call python --version",
      "ECHO pip 版本号",
      "call pip --version",
      "",
      "",
      "CALL \"%~dp0python/python.exe\" ${1:py脚本路径} ${2:参数}",
      ""
    ],
    "description": "python-embed 嵌入式环境启动"
  },
  "python embed 环境变量": {
    "prefix": "set_python_embed_env",
    "body": [
      "set systemPath=%path%",
      "@REM systemPath 设置为系统初始化环境变量",
      "set systemPath=C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\bin32;C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\bin;C:\\WINDOWS;C:\\WINDOWS\\system32;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\",
      "@REM ECHO 添加临时系统环境变量",
      "ECHO 修改 python*embed* 目录名为 python",
      "for /D %%i in (python*embed*) do ( ren %%i \"python\" )",
      "set PYTHON_HOME=%~dp0python;%~dp0python\\Scripts",
      "set path=%PYTHON_HOME%;%systemPath%;",
      "ECHO %path%",
      ""
    ],
    "description": ["python embed 环境变量"]
  }
}
