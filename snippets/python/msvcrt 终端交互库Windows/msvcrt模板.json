{
  "msvcrt.创建控制台交互入口函数模板": {
    "prefix": "msvcrt_main =msvcrt",
    "body": [
      "def main(commands=sys.argv):",
      "    if isinstance(commands, list):",
      "        commands = commands[1:]",
      "    else:",
      "        commands = commands",
      "    options = {",
      "        \"1 功能1\": function1,",
      "        \"2 功能2\": function2,",
      "    }",
      "    idxs = list(options.keys())",
      "    functions = list(options.values())",
      "",
      "    if commands:",
      "        # * 接收命令行参数",
      "        command = commands[0]",
      "        if \"/\" in command:",
      "            command = command.strip(\"/\")",
      "        elif \"-\" in command:",
      "            command = command.strip(\"-\")",
      "        try:",
      "            # comment: 尝试转换参数为整数",
      "            cmd_idx = int(command)",
      "        except ValueError:",
      "            # comment: 如果转换失败, 则尝试匹配命令",
      "            print(f\"命令匹配失败, 请重新输入\\n{'\\n'.join(idxs)}\")",
      "            return",
      "        except Exception as error:  # Exception: 所有异常的基类, 如需对指定类型的异常进行处理, 在上方添加 except [指定异常类型] 即可",
      "            print(\"错误类型: \", type(error))",
      "            print(\"错误信息: \", error)",
      "            raise error  # raise: 抛出异常, 程序终止",
      "        command = int(command)",
      "        if command not in range(1, len(idxs) + 1):",
      "            print(f\"命令匹配失败, 请重新输入\\n{'\\n'.join(idxs)}\")",
      "            return",
      "        print(f\"执行命令: {idxs[cmd_idx - 1]}\")",
      "        functions[cmd_idx - 1]()",
      "    else:",
      "        # * 接收终端交互输入 (# [1]=49; [2]=50)",
      "        while True:",
      "            print(f\"{'='*10} 字体管理器{'='*10}\")",
      "            print(\"请选择操作:\")",
      "            for idx, option in enumerate(idxs):",
      "                print(f\"[{idx+1}] - {option}\")",
      "            key_b = msvcrt.getch()  # 获取键盘输入按键的ASCII码 -> bytes 类型; 需要 ord() 方法解码为字符串",
      "            key = ord(key_b)",
      "            if key == 27:  # [ESC] 退出程序",
      "                print(\"退出程序...\")",
      "                return",
      "            else:",
      "                if key not in range(49, len(idxs) + 49):",
      "                    print(f\"\\n命令匹配失败, 请重新输入\\n{'\\n'.join(idxs)}\\n\")",
      "                    continue",
      "                print(f\"\\n执行命令: {idxs[key - 49]}\")",
      "                functions[key - 49]()",
      ""
    ],
    "description": "msvcrt.创建控制台交互入口函数模板"
  }
}
